<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Stephanie Manel" />

<meta name="date" content="2015-03-19" />

<title>Calculating genetic differentiation and clustering methods from SNP data</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/spacelab.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>
<!---

<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
  padding-right: 50px;
  padding-left: -50px;
}
@media (max-width: 979px) {
  body {
    padding-top: 0;
  }
}

 offset scroll position for anchor links (for fixed navbar)  
@media (min-width: 980px) {
  .section h2 {
    padding-top: 52px;
    margin-top: -52px;
  }
  .section h3 {
    padding-top: 52px;
    margin-top: -52px;
  }
}


/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

</style>
-->



<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h2 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h3 {
  padding-top: 55px;
  margin-top: -55px;
}
/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}
/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}
</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; }
code > span.dt { color: #204a87; }
code > span.dv { color: #0000cf; }
code > span.bn { color: #0000cf; }
code > span.fl { color: #0000cf; }
code > span.ch { color: #4e9a06; }
code > span.st { color: #4e9a06; }
code > span.co { color: #8f5902; font-style: italic; }
code > span.ot { color: #8f5902; }
code > span.al { color: #ef2929; }
code > span.fu { color: #000000; }
code > span.er { font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- HOME -->
      <a class="navbar-brand" href="index.html"><b>Population Genetics in R</b></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <!-- Table of contents -->
        <li class="dropdown">
          <a href="chapters" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Users <span class="caret"></span></a>
          <ol class="dropdown-menu">
              <li><a href="GETSTARTED.html">Getting Started</a></li>
              <li class="divider"></li>
              <li class="dropdown-header">For SNP data:</li>
              <!-- <li class="divider"></li> -->
              <li><a href="StartSNP.html">Basic statistics</a></li>
              <li><a href="DifferentiationSNP.html">Population differentiation</a></li>
              <li><a href="VignetteIndvidualGeneticDistancesSNP.html">Genetic Distance (individual-based)</a></li>
              <!-- <li><a href="SNP.html">SNPs</a></li> -->
              <li class="divider"></li>
              <li class="dropdown-header">For sequence data:</li>
              <!-- <li class="divider"></li>   -->
              <li><a href="SummarySequenceData.html">Summary statistics</a></li>
              <li><a href="PopDiffSequenceData.html">Population differentiation</a></li>
          </ol>
        </li>
        <!-- Appendices dropdown -->
        <li class="dropdown">
          <a href="appendices" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Package Developers <span class="caret"></span></a>
          <ul class = "dropdown-menu", role = "menu">
           <li><a href = "DEVELOPER.html">Introduction</a></li>  
          </ul>
        </li>
        <!-- Author button -->
        <li class="dropdown">
          <a href="about" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Contribute! <span class="caret"></span></a>
          <ul class = "dropdown-menu", role = "menu">
           <li><a href = "CONTRIBUTING.html">How to contribute</a></li>  
           <li><a href="https://github.com/NESCent/popgenInfo">Source repository</a></li>  
		  </ul>
        </li>
        <li class = "button">
          <a href="LinksToResources.html">Useful Links</a>
        </li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- <div class="container">
<div class="row">
<div class="span10 offset1"> -->

<div id="header">
<h1 class="title">Calculating genetic differentiation and clustering methods from SNP data</h1>
<h4 class="author"><em>Stephanie Manel</em></h4>
<h4 class="date"><em>March 19, 2015</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#resourcespackages">Resources/Packages</a></li>
<li><a href="#workflow">Workflow</a><ul>
<li><a href="#f_st-observed-and-expected-heterozygosity-package-hierfstat"><span class="math">\(F_{st}\)</span> (observed and expected heterozygosity) (package hierfstat)</a></li>
<li><a href="#unsupervised-clustering">Unsupervised clustering</a></li>
</ul></li>
<li><a href="#conclusions">Conclusions</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this vignette, we will discuss how to assess population genetic structure from SNP data at population level. We will estimate <span class="math">\(F_{st}\)</span> per population, Pairwise <span class="math">\(F_{st}\)</span>, AMOVA (Hierarchical <span class="math">\(F_{st}\)</span>). We will finally assess the genetic structure at individual level assuming that we do not know populations using a multivariate analysis.</p>
<p>The dataset used for those analysis concerns the plant: lodgepole pine (<em>Pinus contorta</em>, <em>Pinaceae</em>). You can have more information on this data set and the species on the web site of A. Eckert: (<a href="http://eckertdata.blogspot.fr/" class="uri">http://eckertdata.blogspot.fr/</a>). But here the dataset is used as a test dataset with no idea of interpreting the results in a biological way. We will work on a subset of the dataset to make the calculations faster.</p>
</div>
<div id="resourcespackages" class="section level1">
<h1>Resources/Packages</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(adegenet)
<span class="kw">library</span>(hierfstat)</code></pre>
</div>
<div id="workflow" class="section level1">
<h1>Workflow</h1>
<div id="import-data" class="section level3">
<h3>Import data</h3>
<p>The data are stored in a text file (genotype=AA..). We will import the dataset in R as a data frame, and then convert the SNP data file into <a href="http://www.inside-r.org/packages/cran/adegenet/docs/.valid.genind">genind</a> objects.</p>
<p>Dataset “Master_Pinus_data_genotype.txt” can be downloaded <a href="https://github.com/NESCent/popgenInfo/tree/master/data/Master_Pinus_data_genotype.txt">here</a>.</p>
<p>The text file is a matrix of (550 rows x 3086 columns). It contains 4 extra columns: first column is the label of the individuals, the three other are description of the region, all the other columns are for the genotypes as (AA or AT…).</p>
<p>When you import the data, you need to be in the right directory.</p>
<pre class="sourceCode r"><code class="sourceCode r">Mydata &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;Master_Pinus_data_genotype.txt&quot;</span>, <span class="dt">header =</span> T)   
<span class="kw">dim</span>(Mydata) </code></pre>
<pre><code>## [1]  550 3086</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ind &lt;-<span class="st"> </span><span class="kw">as.character</span>(Mydata$tree_id) <span class="co">#use later with adegent (individual labels)</span>
population &lt;-<span class="st"> </span><span class="kw">as.character</span>(Mydata$state) <span class="co">#use later with adegenet (population labels)</span>
county &lt;-<span class="st"> </span>Mydata$county 
<span class="kw">dim</span>(Mydata) <span class="co">#550 individuals x 3082 SNPs</span></code></pre>
<pre><code>## [1]  550 3086</code></pre>
<p>Data conversion</p>
<p>To convert MydataR to genind objects (adegent), the object locus needs to contain only genotypes. We decrease the number of snp to make the calculations faster and keep only 20 SNPs in the object locus. We convert Mydata1 in a fstat object (Mydata2)</p>
<pre class="sourceCode r"><code class="sourceCode r">locus &lt;-<span class="st"> </span>Mydata[, -<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">25</span>:<span class="kw">ncol</span>(Mydata))] 
Mydata1 &lt;-<span class="st"> </span><span class="kw">df2genind</span>(locus, <span class="dt">ploidy =</span> <span class="dv">2</span>, <span class="dt">ind.names =</span> ind, <span class="dt">pop =</span> population)
Mydata1</code></pre>
<pre><code>## 
##    #####################
##    ### Genind object ### 
##    #####################
## - genotypes of individuals - 
## 
## S4 class:  genind
## @call: df2genind(X = locus, ind.names = ind, pop = population, ploidy = 2)
## 
## @tab:  550 x 40 matrix of genotypes
## 
## @ind.names: vector of  550 individual names
## @loc.names: vector of  20 locus names
## @loc.nall: number of alleles per locus
## @loc.fac: locus factor for the  40 columns of @tab
## @all.names: list of  20 components yielding allele names for each locus
## @ploidy:  2
## @type:  codom
## 
## Optional contents: 
## @pop:  factor giving the population of each individual
## @pop.names:  factor giving the population of each individual
## 
## @other: - empty -</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Mydata2 &lt;-<span class="st"> </span><span class="kw">genind2hierfstat</span>(Mydata1) </code></pre>
</div>
<div id="f_st-observed-and-expected-heterozygosity-package-hierfstat" class="section level2">
<h2><span class="math">\(F_{st}\)</span> (observed and expected heterozygosity) (package hierfstat)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">basic.stats</span>(Mydata2) <span class="co"># Fst following Nei (1987)</span></code></pre>
<pre><code>## $n.ind.samp
##                  1  2   3  4   5 6  7  8 9 10 11
## X0.10037.01.257 10 73 170 57 168 7 10 24 9  9  4
## X0.10040.02.394 10 73 168 58 168 7  9 24 9  9  4
## X0.10044.01.392  8 71 157 54 161 7 10 24 8  9  4
## X0.10048.01.60  10 72 171 57 169 7 10 24 8  9  4
## X0.10051.02.166 10 73 171 58 168 7 10 24 9  9  4
## X0.10054.01.402 10 73 171 58 168 7 10 24 9  9  4
## X0.10067.03.111 10 73 175 58 167 6 10 24 9  9  4
## X0.10079.02.168  9 73 175 58 168 7 10 24 9  9  4
## X0.10112.01.169 10 73 176 58 167 7 10 24 9  9  4
## X0.10113.01.119 10 73 173 58 169 7 10 24 8  9  4
## X0.10116.01.165 10 73 174 58 169 7 10 24 9  9  4
## X0.10151.01.86  10 73 172 58 168 7 10 24 8  9  4
## X0.10162.01.255 10 71 173 57 168 7 10 24 9  9  4
## X0.10207.01.280 10 73 173 58 168 6 10 24 9  9  4
## X0.10210.01.41   9 64 157 54 156 4  6 24 9  8 NA
## X0.10219.01.433 10 72 173 58 167 7 10 24 9  9  4
## X0.1022.02.173  10 70 175 53 165 7 10 24 9  7  4
## X0.10240.01.410 10 72 171 58 166 7 10 22 9  9  4
## X0.10262.01.558 10 73 176 58 168 6  9 24 9  9  4
## X0.10266.01.426 10 73 176 58 167 7 10 24 9  9  4
## 
## $pop.freq
## $pop.freq$X0.10037.01.257
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.5000 0.6781 0.7118 0.7368 0.7351 0.5000 0.5500 0.7500 0.8333 0.8889
##   2 0.5000 0.3219 0.2882 0.2632 0.2649 0.5000 0.4500 0.2500 0.1667 0.1111
##    
## x       11
##   1 0.7500
##   2 0.2500
## 
## $pop.freq$X0.10040.02.394
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.3500 0.4041 0.4881 0.5345 0.4821 0.4286 0.5000 0.5208 0.2778 0.3333
##   2 0.6500 0.5959 0.5119 0.4655 0.5179 0.5714 0.5000 0.4792 0.7222 0.6667
##    
## x       11
##   1 0.6250
##   2 0.3750
## 
## $pop.freq$X0.10044.01.392
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.7500 0.5704 0.5223 0.5093 0.4503 0.0714 0.5000 0.5625 0.5000 0.3333
##   2 0.2500 0.4296 0.4777 0.4907 0.5497 0.9286 0.5000 0.4375 0.5000 0.6667
##    
## x       11
##   1 0.0000
##   2 1.0000
## 
## $pop.freq$X0.10048.01.60
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.3500 0.2847 0.3246 0.2544 0.3432 0.6429 0.6000 0.3125 0.5625 0.4444
##   2 0.6500 0.7153 0.6754 0.7456 0.6568 0.3571 0.4000 0.6875 0.4375 0.5556
##    
## x       11
##   1 0.7500
##   2 0.2500
## 
## $pop.freq$X0.10051.02.166
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.0000 0.1507 0.0936 0.0345 0.0387 0.0000 0.0000 0.0417 0.0000 0.0000
##   2 1.0000 0.8493 0.9064 0.9655 0.9613 1.0000 1.0000 0.9583 1.0000 1.0000
##    
## x       11
##   1 0.0000
##   2 1.0000
## 
## $pop.freq$X0.10054.01.402
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.6000 0.3904 0.4971 0.4052 0.4821 0.7143 0.7500 0.6667 0.7222 0.8889
##   2 0.4000 0.6096 0.5029 0.5948 0.5179 0.2857 0.2500 0.3333 0.2778 0.1111
##    
## x       11
##   1 0.6250
##   2 0.3750
## 
## $pop.freq$X0.10067.03.111
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.9500 0.9863 0.9571 1.0000 0.9521 1.0000 0.9500 0.8958 0.9444 1.0000
##   2 0.0500 0.0137 0.0429 0.0000 0.0479 0.0000 0.0500 0.1042 0.0556 0.0000
##    
## x       11
##   1 0.8750
##   2 0.1250
## 
## $pop.freq$X0.10079.02.168
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.1111 0.0205 0.0371 0.0517 0.0327 0.0000 0.0000 0.1667 0.0556 0.0000
##   2 0.8889 0.9795 0.9629 0.9483 0.9673 1.0000 1.0000 0.8333 0.9444 1.0000
##    
## x       11
##   1 0.0000
##   2 1.0000
## 
## $pop.freq$X0.10112.01.169
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.9500 0.9110 0.9233 0.9569 0.9641 1.0000 1.0000 0.9167 1.0000 0.9444
##   2 0.0500 0.0890 0.0767 0.0431 0.0359 0.0000 0.0000 0.0833 0.0000 0.0556
##    
## x       11
##   1 1.0000
##   2 0.0000
## 
## $pop.freq$X0.10113.01.119
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.6000 0.7192 0.6445 0.6983 0.6509 0.6429 0.8500 0.7292 0.7500 0.5556
##   2 0.4000 0.2808 0.3555 0.3017 0.3491 0.3571 0.1500 0.2708 0.2500 0.4444
##    
## x       11
##   1 0.7500
##   2 0.2500
## 
## $pop.freq$X0.10116.01.165
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 1.0000 0.9658 0.9741 0.9828 0.9793 0.9286 1.0000 1.0000 0.9444 1.0000
##   2 0.0000 0.0342 0.0259 0.0172 0.0207 0.0714 0.0000 0.0000 0.0556 0.0000
##    
## x       11
##   1 1.0000
##   2 0.0000
## 
## $pop.freq$X0.10151.01.86
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.9000 0.9521 0.9244 0.8362 0.8869 0.9286 1.0000 0.9167 1.0000 1.0000
##   2 0.1000 0.0479 0.0756 0.1638 0.1131 0.0714 0.0000 0.0833 0.0000 0.0000
##    
## x       11
##   1 1.0000
##   2 0.0000
## 
## $pop.freq$X0.10162.01.255
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.9500 0.9085 0.9249 0.9649 0.9762 0.9286 0.9500 0.9583 0.9444 1.0000
##   2 0.0500 0.0915 0.0751 0.0351 0.0238 0.0714 0.0500 0.0417 0.0556 0.0000
##    
## x       11
##   1 1.0000
##   2 0.0000
## 
## $pop.freq$X0.10207.01.280
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.7000 0.5890 0.5751 0.6983 0.7917 0.9167 0.9000 0.7708 0.8889 0.8333
##   2 0.3000 0.4110 0.4249 0.3017 0.2083 0.0833 0.1000 0.2292 0.1111 0.1667
##    
## x       11
##   1 0.7500
##   2 0.2500
## 
## $pop.freq$X0.10210.01.41
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 1.0000 0.9219 0.9427 0.9444 0.9423 0.8750 0.9167 1.0000 0.9444 0.9375
##   2 0.0000 0.0781 0.0573 0.0556 0.0577 0.1250 0.0833 0.0000 0.0556 0.0625
##    
## x   11
##   1   
##   2   
## 
## $pop.freq$X0.10219.01.433
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.1000 0.1528 0.2139 0.2586 0.1587 0.3571 0.4000 0.1875 0.2778 0.2778
##   2 0.9000 0.8472 0.7861 0.7414 0.8413 0.6429 0.6000 0.8125 0.7222 0.7222
##    
## x       11
##   1 0.2500
##   2 0.7500
## 
## $pop.freq$X0.1022.02.173
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.3500 0.1929 0.2571 0.2736 0.2727 0.7143 0.4000 0.3542 0.2222 0.4286
##   2 0.6500 0.8071 0.7429 0.7264 0.7273 0.2857 0.6000 0.6458 0.7778 0.5714
##    
## x       11
##   1 0.2500
##   2 0.7500
## 
## $pop.freq$X0.10240.01.410
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.7000 0.5208 0.2836 0.4224 0.2711 0.7143 0.5500 0.6591 0.5000 0.5000
##   2 0.3000 0.4792 0.7164 0.5776 0.7289 0.2857 0.4500 0.3409 0.5000 0.5000
##    
## x       11
##   1 0.1250
##   2 0.8750
## 
## $pop.freq$X0.10262.01.558
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 0.8500 0.8973 0.9091 0.9052 0.8929 0.9167 0.7222 0.9792 0.8889 0.8333
##   2 0.1500 0.1027 0.0909 0.0948 0.1071 0.0833 0.2778 0.0208 0.1111 0.1667
##    
## x       11
##   1 0.7500
##   2 0.2500
## 
## $pop.freq$X0.10266.01.426
##    
## x        1      2      3      4      5      6      7      8      9     10
##   1 1.0000 0.9384 0.9432 0.9310 0.9192 1.0000 1.0000 0.9167 0.9444 1.0000
##   2 0.0000 0.0616 0.0568 0.0690 0.0808 0.0000 0.0000 0.0833 0.0556 0.0000
##    
## x       11
##   1 1.0000
##   2 0.0000
## 
## 
## $Ho
##                      1      2      3      4      5      6      7      8
## X0.10037.01.257 0.6000 0.4795 0.3765 0.3509 0.4226 1.0000 0.7000 0.5000
## X0.10040.02.394 0.3000 0.4795 0.4762 0.5517 0.4881 0.5714 0.5556 0.6250
## X0.10044.01.392 0.2500 0.4366 0.4968 0.4630 0.4658 0.1429 0.4000 0.6250
## X0.10048.01.60  0.3000 0.4028 0.3684 0.3333 0.4260 0.4286 0.4000 0.4583
## X0.10051.02.166 0.0000 0.2740 0.1637 0.0690 0.0655 0.0000 0.0000 0.0833
## X0.10054.01.402 0.6000 0.4795 0.5146 0.5000 0.4405 0.2857 0.5000 0.4167
## X0.10067.03.111 0.1000 0.0274 0.0857 0.0000 0.0838 0.0000 0.1000 0.2083
## X0.10079.02.168 0.2222 0.0411 0.0743 0.0690 0.0655 0.0000 0.0000 0.3333
## X0.10112.01.169 0.1000 0.1507 0.1534 0.0862 0.0719 0.0000 0.0000 0.1667
## X0.10113.01.119 0.4000 0.4521 0.4220 0.4655 0.5089 0.4286 0.3000 0.4583
## X0.10116.01.165 0.0000 0.0685 0.0402 0.0345 0.0414 0.1429 0.0000 0.0000
## X0.10151.01.86  0.2000 0.0959 0.1047 0.2931 0.1667 0.1429 0.0000 0.1667
## X0.10162.01.255 0.1000 0.1549 0.1387 0.0702 0.0476 0.1429 0.1000 0.0833
## X0.10207.01.280 0.4000 0.4110 0.4566 0.4310 0.3333 0.1667 0.2000 0.2083
## X0.10210.01.41  0.0000 0.1250 0.0892 0.1111 0.1026 0.2500 0.1667 0.0000
## X0.10219.01.433 0.2000 0.2222 0.3237 0.3793 0.2814 0.7143 0.4000 0.2917
## X0.1022.02.173  0.5000 0.2714 0.4343 0.3585 0.4242 0.5714 0.6000 0.5417
## X0.10240.01.410 0.4000 0.4583 0.3450 0.5000 0.3976 0.5714 0.5000 0.5000
## X0.10262.01.558 0.3000 0.1507 0.1591 0.1552 0.1190 0.1667 0.5556 0.0417
## X0.10266.01.426 0.0000 0.1233 0.0909 0.1034 0.1497 0.0000 0.0000 0.1667
##                      9     10   11
## X0.10037.01.257 0.3333 0.2222 0.50
## X0.10040.02.394 0.1111 0.4444 0.75
## X0.10044.01.392 0.5000 0.2222 0.00
## X0.10048.01.60  0.6250 0.4444 0.50
## X0.10051.02.166 0.0000 0.0000 0.00
## X0.10054.01.402 0.3333 0.2222 0.75
## X0.10067.03.111 0.1111 0.0000 0.25
## X0.10079.02.168 0.1111 0.0000 0.00
## X0.10112.01.169 0.0000 0.1111 0.00
## X0.10113.01.119 0.5000 0.4444 0.50
## X0.10116.01.165 0.1111 0.0000 0.00
## X0.10151.01.86  0.0000 0.0000 0.00
## X0.10162.01.255 0.1111 0.0000 0.00
## X0.10207.01.280 0.2222 0.3333 0.00
## X0.10210.01.41  0.1111 0.1250  NaN
## X0.10219.01.433 0.3333 0.3333 0.50
## X0.1022.02.173  0.2222 0.8571 0.00
## X0.10240.01.410 0.5556 0.5556 0.25
## X0.10262.01.558 0.2222 0.1111 0.50
## X0.10266.01.426 0.1111 0.0000 0.00
## 
## $Hs
##                      1      2      3      4      5      6      7      8
## X0.10037.01.257 0.5222 0.4393 0.4116 0.3916 0.3905 0.5000 0.5111 0.3804
## X0.10040.02.394 0.4889 0.4850 0.5013 0.5015 0.5009 0.5238 0.5278 0.5072
## X0.10044.01.392 0.4107 0.4940 0.5006 0.5049 0.4967 0.1429 0.5333 0.5000
## X0.10048.01.60  0.4889 0.4102 0.4399 0.3831 0.4522 0.5000 0.5111 0.4384
## X0.10051.02.166 0.0000 0.2576 0.1701 0.0672 0.0746 0.0000 0.0000 0.0815
## X0.10054.01.402 0.5000 0.4793 0.5014 0.4861 0.5010 0.4524 0.3889 0.4547
## X0.10067.03.111 0.1000 0.0272 0.0823 0.0000 0.0915 0.0000 0.1000 0.1902
## X0.10079.02.168 0.2083 0.0405 0.0717 0.0992 0.0635 0.0000 0.0000 0.2826
## X0.10112.01.169 0.1000 0.1634 0.1420 0.0832 0.0695 0.0000 0.0000 0.1558
## X0.10113.01.119 0.5111 0.4064 0.4597 0.4247 0.4557 0.5000 0.2667 0.4022
## X0.10116.01.165 0.0000 0.0666 0.0506 0.0342 0.0407 0.1429 0.0000 0.0000
## X0.10151.01.86  0.1889 0.0919 0.1402 0.2762 0.2013 0.1429 0.0000 0.1558
## X0.10162.01.255 0.1000 0.1676 0.1394 0.0683 0.0466 0.1429 0.1000 0.0815
## X0.10207.01.280 0.4444 0.4880 0.4902 0.4250 0.3308 0.1667 0.1889 0.3641
## X0.10210.01.41  0.0000 0.1453 0.1085 0.1059 0.1091 0.2500 0.1667 0.0000
## X0.10219.01.433 0.1889 0.2610 0.3373 0.3869 0.2678 0.4762 0.5111 0.3116
## X0.1022.02.173  0.4778 0.3139 0.3830 0.4017 0.3978 0.4286 0.5000 0.4656
## X0.10240.01.410 0.4444 0.5029 0.4077 0.4921 0.3964 0.4286 0.5222 0.4589
## X0.10262.01.558 0.2667 0.1859 0.1658 0.1733 0.1921 0.1667 0.4167 0.0417
## X0.10266.01.426 0.0000 0.1164 0.1075 0.1298 0.1491 0.0000 0.0000 0.1558
##                      9     10     11
## X0.10037.01.257 0.2917 0.2083 0.4167
## X0.10040.02.394 0.4444 0.4722 0.5000
## X0.10044.01.392 0.5357 0.4861 0.0000
## X0.10048.01.60  0.5179 0.5278 0.4167
## X0.10051.02.166 0.0000 0.0000 0.0000
## X0.10054.01.402 0.4306 0.2083 0.5000
## X0.10067.03.111 0.1111 0.0000 0.2500
## X0.10079.02.168 0.1111 0.0000 0.0000
## X0.10112.01.169 0.0000 0.1111 0.0000
## X0.10113.01.119 0.3929 0.5278 0.4167
## X0.10116.01.165 0.1111 0.0000 0.0000
## X0.10151.01.86  0.0000 0.0000 0.0000
## X0.10162.01.255 0.1111 0.0000 0.0000
## X0.10207.01.280 0.2083 0.2917 0.5000
## X0.10210.01.41  0.1111 0.1250     NA
## X0.10219.01.433 0.4306 0.4306 0.4167
## X0.1022.02.173  0.3750 0.5000 0.5000
## X0.10240.01.410 0.5278 0.5278 0.2500
## X0.10262.01.558 0.2083 0.3056 0.4167
## X0.10266.01.426 0.1111 0.0000 0.0000
## 
## $Fis
##                       1       2       3       4       5       6       7
## X0.10037.01.257 -0.1489 -0.0914  0.0854  0.1040 -0.0822 -1.0000 -0.3696
## X0.10040.02.394  0.3864  0.0114  0.0501 -0.1001  0.0255 -0.0909 -0.0526
## X0.10044.01.392  0.3913  0.1161  0.0076  0.0830  0.0621  0.0000  0.2500
## X0.10048.01.60   0.3864  0.0181  0.1626  0.1300  0.0579  0.1429  0.2174
## X0.10051.02.166     NaN -0.0635  0.0376 -0.0270  0.1227     NaN     NaN
## X0.10054.01.402 -0.2000 -0.0004 -0.0263 -0.0286  0.1209  0.3684 -0.2857
## X0.10067.03.111  0.0000 -0.0070 -0.0419     NaN  0.0840     NaN  0.0000
## X0.10079.02.168 -0.0667 -0.0141 -0.0357  0.3049 -0.0309     NaN     NaN
## X0.10112.01.169  0.0000  0.0780 -0.0802 -0.0364 -0.0343     NaN     NaN
## X0.10113.01.119  0.2174 -0.1124  0.0820 -0.0962 -0.1168  0.1429 -0.1250
## X0.10116.01.165     NaN -0.0286  0.2043 -0.0088 -0.0182  0.0000     NaN
## X0.10151.01.86  -0.0588 -0.0435  0.2538 -0.0613  0.1721  0.0000     NaN
## X0.10162.01.255  0.0000  0.0756  0.0048 -0.0275 -0.0214  0.0000  0.0000
## X0.10207.01.280  0.1000  0.1579  0.0685 -0.0142 -0.0075  0.0000 -0.0588
## X0.10210.01.41      NaN  0.1399  0.1780 -0.0495  0.0599  0.0000  0.0000
## X0.10219.01.433 -0.0588  0.1484  0.0403  0.0195 -0.0511 -0.5000  0.2174
## X0.1022.02.173  -0.0465  0.1352 -0.1339  0.1075 -0.0664 -0.3333 -0.2000
## X0.10240.01.410  0.1000  0.0887  0.1538 -0.0160 -0.0030 -0.3333  0.0426
## X0.10262.01.558 -0.1250  0.1894  0.0403  0.1047  0.3803  0.0000 -0.3333
## X0.10266.01.426     NaN -0.0588  0.1546  0.2028 -0.0044     NaN     NaN
##                       8       9      10   11
## X0.10037.01.257 -0.3143 -0.1429 -0.0667 -0.2
## X0.10040.02.394 -0.2321  0.7500  0.0588 -0.5
## X0.10044.01.392 -0.2500  0.0667  0.5429  NaN
## X0.10048.01.60  -0.0455 -0.2069  0.1579 -0.2
## X0.10051.02.166 -0.0222     NaN     NaN  NaN
## X0.10054.01.402  0.0837  0.2258 -0.0667 -0.5
## X0.10067.03.111 -0.0952  0.0000     NaN  0.0
## X0.10079.02.168 -0.1795  0.0000     NaN  NaN
## X0.10112.01.169 -0.0698     NaN  0.0000  NaN
## X0.10113.01.119 -0.1396 -0.2727  0.1579 -0.2
## X0.10116.01.165     NaN  0.0000     NaN  NaN
## X0.10151.01.86  -0.0698     NaN     NaN  NaN
## X0.10162.01.255 -0.0222  0.0000     NaN  NaN
## X0.10207.01.280  0.4279 -0.0667 -0.1429  1.0
## X0.10210.01.41      NaN  0.0000  0.0000  NaN
## X0.10219.01.433  0.0640  0.2258  0.2258 -0.2
## X0.1022.02.173  -0.1634  0.4074 -0.7143  1.0
## X0.10240.01.410 -0.0896 -0.0526 -0.0526  0.0
## X0.10262.01.558  0.0000 -0.0667  0.6364 -0.2
## X0.10266.01.426 -0.0698  0.0000     NaN  NaN
## 
## $perloc
##                     Ho     Hs     Ht     Dst    Htp    Dstp     Fst
## X0.10037.01.257 0.4986 0.4079 0.4259  0.0180 0.4277  0.0198  0.0422
## X0.10040.02.394 0.4866 0.4971 0.4968 -0.0003 0.4968 -0.0003 -0.0005
## X0.10044.01.392 0.3638 0.4232 0.4931  0.0699 0.5000  0.0768  0.1417
## X0.10048.01.60  0.4261 0.4626 0.4953  0.0327 0.4986  0.0359  0.0660
## X0.10051.02.166 0.0596 0.0613 0.0634  0.0020 0.0636  0.0023  0.0323
## X0.10054.01.402 0.4584 0.4481 0.4761  0.0280 0.4789  0.0308  0.0588
## X0.10067.03.111 0.0879 0.0853 0.0853  0.0000 0.0853 -0.0001 -0.0005
## X0.10079.02.168 0.0833 0.0808 0.0830  0.0022 0.0832  0.0024  0.0263
## X0.10112.01.169 0.0764 0.0766 0.0760 -0.0006 0.0760 -0.0007 -0.0079
## X0.10113.01.119 0.4436 0.4331 0.4294 -0.0037 0.4290 -0.0041 -0.0087
## X0.10116.01.165 0.0399 0.0407 0.0402 -0.0004 0.0402 -0.0005 -0.0105
## X0.10151.01.86  0.1063 0.1113 0.1125  0.0012 0.1126  0.0013  0.0106
## X0.10162.01.255 0.0863 0.0879 0.0862 -0.0018 0.0860 -0.0020 -0.0207
## X0.10207.01.280 0.2875 0.3521 0.3613  0.0092 0.3622  0.0101  0.0254
## X0.10210.01.41  0.1081 0.1108 0.1089 -0.0019 0.1087 -0.0021 -0.0174
## X0.10219.01.433 0.3618 0.3648 0.3656  0.0009 0.3657  0.0009  0.0023
## X0.1022.02.173  0.4346 0.4267 0.4490  0.0222 0.4512  0.0245  0.0495
## X0.10240.01.410 0.4576 0.4530 0.5006  0.0477 0.5054  0.0524  0.0952
## X0.10262.01.558 0.2256 0.2292 0.2305  0.0013 0.2306  0.0014  0.0055
## X0.10266.01.426 0.0677 0.0720 0.0716 -0.0004 0.0715 -0.0005 -0.0059
##                    Fstp     Fis    Dest
## X0.10037.01.257  0.0462 -0.2224  0.0334
## X0.10040.02.394 -0.0006  0.0210 -0.0006
## X0.10044.01.392  0.1537  0.1403  0.1332
## X0.10048.01.60   0.0721  0.0790  0.0669
## X0.10051.02.166  0.0354  0.0286  0.0024
## X0.10054.01.402  0.0643 -0.0229  0.0558
## X0.10067.03.111 -0.0006 -0.0293 -0.0001
## X0.10079.02.168  0.0288 -0.0308  0.0026
## X0.10112.01.169 -0.0088  0.0036 -0.0007
## X0.10113.01.119 -0.0095 -0.0243 -0.0072
## X0.10116.01.165 -0.0115  0.0193 -0.0005
## X0.10151.01.86   0.0116  0.0443  0.0015
## X0.10162.01.255 -0.0228  0.0192 -0.0021
## X0.10207.01.280  0.0279  0.1834  0.0156
## X0.10210.01.41  -0.0194  0.0245 -0.0024
## X0.10219.01.433  0.0026  0.0082  0.0015
## X0.1022.02.173   0.0542 -0.0185  0.0427
## X0.10240.01.410  0.1037 -0.0102  0.0958
## X0.10262.01.558  0.0060  0.0160  0.0018
## X0.10266.01.426 -0.0064  0.0591 -0.0005
## 
## $overall
##     Ho     Hs     Ht    Dst    Htp   Dstp    Fst   Fstp    Fis   Dest 
## 0.2580 0.2612 0.2725 0.0113 0.2737 0.0124 0.0415 0.0454 0.0124 0.0168 
## 
## attr(,&quot;class&quot;)
## [1] &quot;bas.stats&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wc</span>(Mydata2) <span class="co"># Weir and Cockrham estimate</span></code></pre>
<pre><code>## $call
## wc(ndat = Mydata2)
## 
## $sigma
##                 loc          siga          sigb       sigw
## X0.10037.01.257   1  1.714725e-03 -0.0087645882 0.21164510
## X0.10037.01.257   1  1.714725e-03 -0.0087645882 0.21164510
## X0.10040.02.394   2  4.526643e-04  0.0042637955 0.24489796
## X0.10040.02.394   2  4.526643e-04  0.0042637955 0.24489796
## X0.10044.01.392   3  6.695121e-03  0.0140611957 0.23099415
## X0.10044.01.392   3  6.695121e-03  0.0140611957 0.23099415
## X0.10048.01.60    4  4.730697e-03  0.0208082325 0.19870610
## X0.10048.01.60    4  4.730697e-03  0.0208082325 0.19870610
## X0.10051.02.166   5  1.785523e-03  0.0015271788 0.05985267
## X0.10051.02.166   5  1.785523e-03  0.0015271788 0.05985267
## X0.10054.01.402   6  9.009289e-03  0.0066111224 0.23664825
## X0.10054.01.402   6  9.009289e-03  0.0066111224 0.23664825
## X0.10067.03.111   7  2.973422e-04  0.0001550181 0.03669725
## X0.10067.03.111   7  2.973422e-04  0.0001550181 0.03669725
## X0.10079.02.168   8  8.039338e-04 -0.0003766346 0.03846154
## X0.10079.02.168   8  8.039338e-04 -0.0003766346 0.03846154
## X0.10112.01.169   9  1.900509e-04 -0.0015865255 0.05575868
## X0.10112.01.169   9  1.900509e-04 -0.0015865255 0.05575868
## X0.10113.01.119  10 -3.207687e-05 -0.0079437366 0.22935780
## X0.10113.01.119  10 -3.207687e-05 -0.0079437366 0.22935780
## X0.10116.01.165  11 -1.179487e-04  0.0014186872 0.02102377
## X0.10116.01.165  11 -1.179487e-04  0.0014186872 0.02102377
## X0.10151.01.86   12  8.902828e-04  0.0098352854 0.07090239
## X0.10151.01.86   12  8.902828e-04  0.0098352854 0.07090239
## X0.10162.01.255  13  3.409127e-04  0.0007088327 0.04889299
## X0.10162.01.255  13  3.409127e-04  0.0007088327 0.04889299
## X0.10207.01.280  14  1.222565e-02  0.0150201429 0.19025735
## X0.10207.01.280  14  1.222565e-02  0.0150201429 0.19025735
## X0.10210.01.41   15 -2.868428e-04  0.0051741346 0.04887984
## X0.10210.01.41   15 -2.868428e-04  0.0051741346 0.04887984
## X0.10219.01.433  16  1.583355e-03  0.0039323641 0.15377532
## X0.10219.01.433  16  1.583355e-03  0.0039323641 0.15377532
## X0.1022.02.173   17  3.682061e-03 -0.0108389170 0.20599251
## X0.1022.02.173   17  3.682061e-03 -0.0108389170 0.20599251
## X0.10240.01.410  18  1.970757e-02  0.0107855418 0.20631970
## X0.10240.01.410  18  1.970757e-02  0.0107855418 0.20631970
## X0.10262.01.558  19  1.996032e-04  0.0152526820 0.07600733
## X0.10262.01.558  19  1.996032e-04  0.0152526820 0.07600733
## X0.10266.01.426  20 -1.968129e-04  0.0035437869 0.05575868
## X0.10266.01.426  20 -1.968129e-04  0.0035437869 0.05575868
## 
## $sigma.loc
##                         lsiga         lsigb      lsigw
## X0.10037.01.257  3.429451e-03 -0.0175291764 0.42329020
## X0.10040.02.394  9.053285e-04  0.0085275910 0.48979592
## X0.10044.01.392  1.339024e-02  0.0281223914 0.46198830
## X0.10048.01.60   9.461394e-03  0.0416164651 0.39741220
## X0.10051.02.166  3.571046e-03  0.0030543577 0.11970534
## X0.10054.01.402  1.801858e-02  0.0132222448 0.47329650
## X0.10067.03.111  5.946844e-04  0.0003100363 0.07339450
## X0.10079.02.168  1.607868e-03 -0.0007532692 0.07692308
## X0.10112.01.169  3.801019e-04 -0.0031730509 0.11151737
## X0.10113.01.119 -6.415373e-05 -0.0158874731 0.45871560
## X0.10116.01.165 -2.358975e-04  0.0028373743 0.04204753
## X0.10151.01.86   1.780566e-03  0.0196705709 0.14180479
## X0.10162.01.255  6.818253e-04  0.0014176653 0.09778598
## X0.10207.01.280  2.445129e-02  0.0300402859 0.38051471
## X0.10210.01.41  -5.736855e-04  0.0103482692 0.09775967
## X0.10219.01.433  3.166710e-03  0.0078647283 0.30755064
## X0.1022.02.173   7.364122e-03 -0.0216778339 0.41198502
## X0.10240.01.410  3.941513e-02  0.0215710837 0.41263941
## X0.10262.01.558  3.992064e-04  0.0305053639 0.15201465
## X0.10266.01.426 -3.936258e-04  0.0070875739 0.11151737
## 
## $per.al
## $per.al$FST
## X0.10037.01.257 X0.10037.01.257 X0.10040.02.394 X0.10040.02.394 
##    0.0083810625    0.0083810625    0.0018134540    0.0018134540 
## X0.10044.01.392 X0.10044.01.392  X0.10048.01.60  X0.10048.01.60 
##    0.0265942742    0.0265942742    0.0210961064    0.0210961064 
## X0.10051.02.166 X0.10051.02.166 X0.10054.01.402 X0.10054.01.402 
##    0.0282674305    0.0282674305    0.0357130728    0.0357130728 
## X0.10067.03.111 X0.10067.03.111 X0.10079.02.168 X0.10079.02.168 
##    0.0080039125    0.0080039125    0.0206726109    0.0206726109 
## X0.10112.01.169 X0.10112.01.169 X0.10113.01.119 X0.10113.01.119 
##    0.0034960122    0.0034960122   -0.0001448938   -0.0001448938 
## X0.10116.01.165 X0.10116.01.165  X0.10151.01.86  X0.10151.01.86 
##   -0.0052833753   -0.0052833753    0.0109065914    0.0109065914 
## X0.10162.01.255 X0.10162.01.255 X0.10207.01.280 X0.10207.01.280 
##    0.0068260712    0.0068260712    0.0562090564    0.0562090564 
##  X0.10210.01.41  X0.10210.01.41 X0.10219.01.433 X0.10219.01.433 
##   -0.0053349093   -0.0053349093    0.0099400141    0.0099400141 
##  X0.1022.02.173  X0.1022.02.173 X0.10240.01.410 X0.10240.01.410 
##    0.0185181115    0.0185181115    0.0832200167    0.0832200167 
## X0.10262.01.558 X0.10262.01.558 X0.10266.01.426 X0.10266.01.426 
##    0.0021824188    0.0021824188   -0.0033298484   -0.0033298484 
## 
## $per.al$FIS
## X0.10037.01.257 X0.10037.01.257 X0.10040.02.394 X0.10040.02.394 
##    -0.043200740    -0.043200740     0.017112560     0.017112560 
## X0.10044.01.392 X0.10044.01.392  X0.10048.01.60  X0.10048.01.60 
##     0.057379673     0.057379673     0.094792136     0.094792136 
## X0.10051.02.166 X0.10051.02.166 X0.10054.01.402 X0.10054.01.402 
##     0.024880785     0.024880785     0.027177257     0.027177257 
## X0.10067.03.111 X0.10067.03.111 X0.10079.02.168 X0.10079.02.168 
##     0.004206475     0.004206475    -0.009889341    -0.009889341 
## X0.10112.01.169 X0.10112.01.169 X0.10113.01.119 X0.10113.01.119 
##    -0.029286732    -0.029286732    -0.035877290    -0.035877290 
## X0.10116.01.165 X0.10116.01.165  X0.10151.01.86  X0.10151.01.86 
##     0.063214442     0.063214442     0.121817787     0.121817787 
## X0.10162.01.255 X0.10162.01.255 X0.10207.01.280 X0.10207.01.280 
##     0.014290456     0.014290456     0.073169944     0.073169944 
##  X0.10210.01.41  X0.10210.01.41 X0.10219.01.433 X0.10219.01.433 
##     0.095721636     0.095721636     0.024934512     0.024934512 
##  X0.1022.02.173  X0.1022.02.173 X0.10240.01.410 X0.10240.01.410 
##    -0.055540443    -0.055540443     0.049678864     0.049678864 
## X0.10262.01.558 X0.10262.01.558 X0.10266.01.426 X0.10266.01.426 
##     0.167134348     0.167134348     0.059757830     0.059757830 
## 
## 
## $per.loc
## $per.loc$FST
##             1             2             3             4             5 
##  0.0083810625  0.0018134540  0.0265942742  0.0210961064  0.0282674305 
##             6             7             8             9            10 
##  0.0357130728  0.0080039125  0.0206726109  0.0034960122 -0.0001448938 
##            11            12            13            14            15 
## -0.0052833753  0.0109065914  0.0068260712  0.0562090564 -0.0053349093 
##            16            17            18            19            20 
##  0.0099400141  0.0185181115  0.0832200167  0.0021824188 -0.0033298484 
## 
## $per.loc$FIS
##            1            2            3            4            5 
## -0.043200740  0.017112560  0.057379673  0.094792136  0.024880785 
##            6            7            8            9           10 
##  0.027177257  0.004206475 -0.009889341 -0.029286732 -0.035877290 
##           11           12           13           14           15 
##  0.063214442  0.121817787  0.014290456  0.073169944  0.095721636 
##           16           17           18           19           20 
##  0.024934512 -0.055540443  0.049678864  0.167134348  0.059757830 
## 
## 
## $FST
## [1] 0.02300324
## 
## $FIS
## [1] 0.03090781
## 
## attr(,&quot;class&quot;)
## [1] &quot;wc&quot;</code></pre>
<div id="hierarchical-f_st-tests-amova-for-snp-dataset" class="section level3">
<h3>Hierarchical <span class="math">\(F_{st}\)</span> tests (=AMOVA for SNP dataset)</h3>
<p>The function <code>varcomp.glob</code> produces a Hierarchical Fst (=AMOVA for SNPs or biallelic markers) It is possible to make permutations on the different levels: The function <code>test.g</code> tests the effect of the population on genetic differentiation. Individuals are randomly permuted among states. The states influence genetic differentiation at 5% level. With the function <code>test.between</code>, the counties are permuted among states. The states influence significantly genetic structuring.</p>
<pre class="sourceCode r"><code class="sourceCode r">loci &lt;-<span class="st"> </span>Mydata2[, -<span class="kw">c</span>(<span class="dv">1</span>)] <span class="co"># Remove the population column</span>
<span class="kw">varcomp.glob</span>(<span class="dt">levels =</span> <span class="kw">data.frame</span>(population, county), loci, <span class="dt">diploid =</span> <span class="ot">TRUE</span>) </code></pre>
<pre><code>## $loc
##                          [,1]          [,2]          [,3]       [,4]
## X0.10037.01.257  4.631785e-03 -0.0075801286 -0.0110876895 0.42329020
## X0.10040.02.394 -3.927184e-06  0.0057909958  0.0035980465 0.48979592
## X0.10044.01.392  1.276810e-02  0.0039247749  0.0247870243 0.46198830
## X0.10048.01.60   6.490717e-03  0.0189152357  0.0255163684 0.39741220
## X0.10051.02.166  2.977513e-03  0.0037478140 -0.0001317105 0.11970534
## X0.10054.01.402  1.806575e-02 -0.0002977277  0.0134753262 0.47329650
## X0.10067.03.111  9.490247e-04 -0.0022733109  0.0022479222 0.07339450
## X0.10079.02.168  1.359482e-03  0.0015693361 -0.0020878338 0.07692308
## X0.10112.01.169  5.570862e-04 -0.0011207466 -0.0022195075 0.11151737
## X0.10113.01.119 -3.038733e-03  0.0190331181 -0.0321043585 0.45871560
## X0.10116.01.165 -4.102906e-04  0.0010983394  0.0019041211 0.04204753
## X0.10151.01.86   1.180089e-03  0.0038425248  0.0163965166 0.14180479
## X0.10162.01.255  2.762257e-04  0.0025535687 -0.0007521869 0.09778598
## X0.10207.01.280  2.419336e-02  0.0016539601  0.0286306732 0.38051471
## X0.10210.01.41  -1.206136e-03  0.0040434594  0.0069081606 0.09775967
## X0.10219.01.433  2.608653e-03  0.0035115484  0.0048812171 0.30755064
## X0.1022.02.173   7.258406e-03  0.0006657100 -0.0222437933 0.41198502
## X0.10240.01.410  3.603309e-02  0.0212763776  0.0035015937 0.41263941
## X0.10262.01.558  5.048435e-04 -0.0006787502  0.0310839391 0.15201465
## X0.10266.01.426 -7.102129e-04  0.0020016810  0.0053850735 0.11151737
## 
## $overall
## population     county        Ind      Error 
## 0.11448482 0.08167778 0.09768890 5.24165877 
## 
## $F
##            population     county        Ind
## Total      0.02068189 0.03543713 0.05308481
## population 0.00000000 0.01506685 0.03308722
## county     0.00000000 0.00000000 0.01829604</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test.g</span>(loci, <span class="dt">level =</span> population) </code></pre>
<pre><code>## $g.star
##   [1] 255.5794 239.1247 227.7028 225.4540 223.1228 217.0165 208.6092
##   [8] 195.4102 216.4116 237.5482 195.6642 196.4769 187.0197 204.0958
##  [15] 212.8697 255.8943 244.8705 182.5021 201.0171 248.0611 230.0287
##  [22] 256.4629 251.5017 197.5176 223.8241 252.2152 249.1126 247.6312
##  [29] 222.1161 229.5433 195.1335 206.7878 201.0319 198.9663 222.7826
##  [36] 199.5343 234.3820 241.5532 239.3030 213.3995 221.2475 184.2939
##  [43] 187.2405 202.4905 199.1311 209.4310 261.6796 224.9174 210.9900
##  [50] 234.6044 257.5437 210.2226 229.8238 217.6880 211.5704 198.1898
##  [57] 239.6139 256.1789 211.8951 219.6328 219.4911 253.2732 230.3539
##  [64] 251.1993 216.8918 216.1678 208.9083 251.0772 249.7822 244.1391
##  [71] 207.3826 254.4984 217.9507 220.6315 229.5754 231.9438 191.6706
##  [78] 220.1216 187.0844 212.6070 201.5196 223.4922 254.6738 228.9492
##  [85] 244.0470 205.0856 245.6552 247.8542 224.6529 203.5746 209.0439
##  [92] 210.2420 206.9118 227.0453 204.8849 224.2963 237.9595 211.2590
##  [99] 195.0478 378.7654
## 
## $p.val
## [1] 0.01</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test.between</span>(loci, <span class="dt">test.lev =</span> population, <span class="dt">rand.unit =</span> county, <span class="dt">nperm =</span> <span class="dv">30</span>) </code></pre>
<pre><code>## $g.star
##  [1] 225.4543 305.7949 286.0973 237.7513 274.4577 236.2317 224.8520
##  [8] 257.1001 240.5661 257.7126 210.9047 301.7541 290.4854 221.6554
## [15] 248.5395 255.7159 237.6829 234.0823 239.0983 227.8434 273.3103
## [22] 303.9509 251.4590 246.6759 237.6023 268.6764 251.9811 219.4399
## [29] 217.6133 378.7654
## 
## $p.val
## [1] 0.03333333</code></pre>
</div>
<div id="pairwise-f_st-package-hierfstat" class="section level3">
<h3>Pairwise <span class="math">\(F_{st}\)</span> (package hierfstat)</h3>
<pre class="sourceCode r"><code class="sourceCode r">loci1 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(loci)
<span class="kw">pp.fst</span>(loci1, <span class="dt">diploid =</span> <span class="ot">TRUE</span>) <span class="co"># Do not work with missing values</span></code></pre>
<pre><code>##      [,1]        [,2]         [,3]
## [1,]  NaN 0.001621662 0.0006154678
## [2,]  NaN         NaN 0.0006318108
## [3,]  NaN         NaN          NaN</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># No test at the moment</span></code></pre>
</div>
</div>
<div id="unsupervised-clustering" class="section level2">
<h2>Unsupervised clustering</h2>
<p>We don’t know the populations and we are looking for. As recommended by T. Jombart, with the function <code>gpr</code> we used the maximum possible number of PCA axis which is 20 here. See detailed tutorial on this method for more information (<a href="http://adegenet.r-forge.r-project.org/" class="uri">http://adegenet.r-forge.r-project.org/</a>) In this example, we used <code>choose.n.clust = FALSE</code> but it is nice to use the option <code>TRUE</code> and then you will be able to choose the number of clusters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># using Kmeans and DIAPC in adegenet </span>
grp &lt;-<span class="st"> </span><span class="kw">find.clusters</span>(Mydata1, <span class="dt">max.n.clust =</span> <span class="dv">10</span>, <span class="dt">n.pca =</span> <span class="dv">20</span>, <span class="dt">choose.n.clust =</span> <span class="ot">FALSE</span>) </code></pre>
<pre><code>## The &quot;ward&quot; method has been renamed to &quot;ward.D&quot;; note new &quot;ward.D2&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(grp)</code></pre>
<pre><code>## [1] &quot;Kstat&quot; &quot;stat&quot;  &quot;grp&quot;   &quot;size&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">grp$grp</code></pre>
<pre><code>##   1066   2040   4004   4005   4018   6009   6013   7033   7056   7069 
##      3      4      5      4      3      2      5      5      1      2 
##   7088   7105   8001   8061   8068   8076   8120   8195   8203   8222 
##      5      1      5      5      5      4      3      4      3      4 
##   8223   8231   8237   8301   8302   8303   8304   8305   8307   8308 
##      3      5      2      5      4      2      4      5      2      2 
##   8309   8310   8313   8314   8316   8317   8318   8319   8320   8323 
##      4      3      5      2      5      4      2      5      5      3 
##   8324   8327   8328   8329   8330   8332   8333   8334   8335   8336 
##      3      5      5      2      5      4      4      1      3      4 
##   8337   8338   8339   8340   8342   8343   8344   8345   8346   8347 
##      5      5      5      5      3      3      2      3      3      5 
##   8349   8350   8351   8352   8353   8354   8355   8356   8357   8358 
##      5      5      3      4      5      5      3      2      3      2 
##   8364   8365   8366   8367   8368   8369   8370   8371   8372   8373 
##      3      5      5      2      5      5      4      3      5      5 
##   8374   8375   8376   8377   8378   8379   8381   8382   8383   8384 
##      5      5      3      3      4      4      5      5      1      2 
##   8385   8386   8387   8388   8389   8390   8391   8392   8393   8395 
##      5      4      5      5      2      3      1      5      3      2 
##   8400   8402   8403   8559   8565   8567   8568   8569   8570   8571 
##      5      5      5      3      2      2      4      3      4      3 
##   8572   8573   8574   8601   8602   8603   8604   8606   8607   8608 
##      1      5      4      3      5      1      4      2      3      2 
##   8609   8610   8611   8613   8615   8616   8618   8619   8620   8621 
##      4      1      5      4      2      4      5      4      2      2 
##   8622   8624   8626   8628   8629   8630   8631   8633   8634   8635 
##      4      1      4      5      2      4      3      5      1      5 
##   8636   8637   8638   8639   8640   8641   8642   8643   8644   8645 
##      1      4      2      2      5      2      4      1      4      4 
##   8646   8647   8648   8651   8652   8653   8654   8655   8656   8657 
##      3      5      2      3      2      4      5      2      5      4 
##   8658   8659   8660   8661   8662   8663   8664   8667   8669   8670 
##      4      4      2      2      4      3      1      4      4      5 
##   8671   8672   8673   8674   8675   8676   8677   8678   8679   8680 
##      4      4      2      2      5      3      4      2      5      2 
##   8683   8685   8686   8687   8688   8689   8691   8692   8693   8694 
##      5      1      1      2      3      4      3      1      2      2 
##   8695   8696   8697   8698   8699   8700   8701   8702   8703   8704 
##      5      2      2      1      2      5      3      3      2      4 
##   8705   8706   9003   9006   9015  10005  11010  11503  11532  12008 
##      1      5      4      2      1      4      3      2      1      2 
##  12012  14010  14015  22212  68087  68088  68090  68095  68130  68131 
##      3      5      2      5      3      3      1      1      3      3 
##  68133  68134  68135   105A   108A   109B   110B   112C   115B   117B 
##      4      3      4      1      2      5      3      4      4      5 
##   118B    11A   120A   121C   127A   128A   131B   132B   136C   138A 
##      4      4      2      2      1      2      1      3      4      5 
##   139B   140B   141A   142B   144C   145A   146C   147A   149B   150A 
##      1      1      2      1      1      5      3      2      1      5 
##   151A   152B   153B   154C   155B   156C   157A   158B    15A   162A 
##      4      5      1      4      1      2      4      4      3      2 
##   166B    16A   171A   173A   174A    17C   188A   189A   190A   191A 
##      3      4      2      2      1      4      3      2      1      1 
##    19A   205B    20A   212A   213A   217C   219A    21A   220A   224A 
##      5      1      1      5      3      1      3      1      4      2 
##   226C   227C   234B   235A   238A    23A   245B   248A   250C   253A 
##      3      5      2      1      1      5      2      4      5      5 
##   254C   257B   258A   260B   262A   264C   265A   268A   269A   270C 
##      4      4      1      1      3      4      3      5      4      1 
##   271A   272B   275A   276B   277A    27A   281A   282B   283C   285C 
##      2      5      1      3      4      4      3      1      3      4 
##   286B   287C   288C   289A   290C   291C   292C   298B   299C   300C 
##      5      3      3      2      3      4      4      2      4      1 
##   302A   303C   305A   306A   307A   311A   316B   320C   322A   323B 
##      1      2      4      3      2      1      5      1      5      1 
##   324A   326A   327A   328B   329B    32A   330A   331B   332C   334A 
##      3      4      4      1      1      4      2      1      2      5 
##   335A   336A   339B   340A   341C   346A   349B    34A   351A   353C 
##      4      2      1      1      2      3      4      1      4      5 
##   355A    35A   360B   361B   362C   365B   366A   368B   369A    36A 
##      4      3      1      1      4      5      4      2      1      4 
##   370C   371B   372A   373B   375A   377B   378B   379B   382A   383C 
##      1      3      3      4      5      1      2      2      3      1 
##   384A   385B   387A   388B   389A   390B   391C   392A   393C   395A 
##      2      1      3      3      4      5      1      4      1      5 
##   397A   398C   400C   407A   408C   409B   410A   411C   412C   414A 
##      1      3      2      1      2      2      3      4      2      1 
##   415A   416B   417A   418A   419B    41C   420B   421A   422B   423C 
##      2      3      5      4      4      5      3      5      3      4 
##   424B   425B   426B   427C   428C   429B    42A   430B   431B   433B 
##      2      3      5      3      2      4      2      4      4      3 
##   434B   435C   436A    43B   441C   442C   443C   448C   449A   450B 
##      5      1      1      5      2      2      1      4      1      3 
##   451B   459A   461A   463A   469C   470A   471B   481A   483A   484A 
##      2      1      4      4      4      1      1      3      3      4 
##   485A   486B   487C   489B    48B   492C   493A   496B   498B   499A 
##      5      4      3      1      1      5      2      1      3      1 
##    49A   500B   501A   502C   514A   515A   519B   520B   526A   527B 
##      1      2      1      2      1      3      1      4      2      5 
##   528C    52A   531A   532A   533A   534A   535C   536A   539A    53C 
##      5      1      4      3      4      5      4      1      1      1 
##   540A   541A   542C   543C   544B   545A   546C   548C   549A    54C 
##      5      1      3      1      5      1      3      3      1      4 
##   551C   552A   553B   554A   555C   556A   557B   558A   559A    55A 
##      5      3      1      5      5      1      1      1      1      1 
##   561A   562A   563A   564B   565C   566B   568B   570A   571A   572C 
##      4      1      1      1      2      5      4      3      1      2 
##   573C   574B   576A   577B   578B   579A    57A   580A   581C   600A 
##      5      4      5      1      1      5      4      5      3      1 
##   601A   603A   605B   606B    60A   612C   613A   618A   619A    61A 
##      4      2      4      3      5      2      3      1      2      3 
##   620C   621A   633B   634C   635A   636C   637B    63B   644B   645A 
##      3      2      3      1      3      3      3      5      3      4 
##   646A    66A    67C    69A    73B    77B     7A    86C    89C    90C 
##      3      2      1      4      5      5      1      4      4      1 
##    92A    93C    94C    97B    98A    99C     9A CRO108 CRO120 CRO121 
##      1      4      1      5      5      1      1      2      2      2 
## CRO133 DF3364  FM406  FM417  FM428  FM442  FM445  S4PT6   SH13    SH7 
##      5      3      2      4      3      5      1      1      2      3 
## Levels: 1 2 3 4 5</code></pre>
<p>The K means procedure detected 5 groups. We will use this number of group in the discriminant analysis (function <code>dapc</code>). On your own dataset, you need to spend more time to estimate the number of cluster.</p>
<pre class="sourceCode r"><code class="sourceCode r">dapc1 &lt;-<span class="st"> </span><span class="kw">dapc</span>(Mydata1, grp$grp, <span class="dt">n.pca =</span> <span class="dv">20</span>, <span class="dt">n.da =</span> <span class="dv">6</span>) 
<span class="kw">scatter</span>(dapc1) <span class="co"># plot of the group</span></code></pre>
<p><img src="DifferentiationSNP_files/figure-html/description_of_clusters-1.png" title="" alt="" width="960" /></p>
<p>Five groups were finally detected and represented by the discriminant analysis. The 11 states are not the good level for population analysis. But we need to remember that we used only 20 SNPs to conduct the analysis.</p>
</div>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<div id="what-did-we-learn-today" class="section level3">
<h3>What did we learn today?</h3>
<p>In this vignette, we learned how to calculate <span class="math">\(F_{st}\)</span> in existing populations and to investigate the effect of population structure on genetic differentiation from hierarchical <span class="math">\(F_{st}\)</span> analysis (like AMOVA in the case of SNP). We also run a multivariate analysis to investigate the genetic structure of the data at individual level assuming no population.</p>
</div>
<div id="what-is-next" class="section level3">
<h3>What is next?</h3>
<p>You may now want to move to the estimation of genetic distances (See vignette DistancesSNP, coming soon)</p>
</div>
</div>
<div id="reference" class="section level1">
<h1>Reference</h1>
<p>Eckert, A. J., A. D. Bower, S. C. González-Martínez, J. L. Wegrzyn, G. Coop and D. B. Neale. 2010. Back to nature: Ecological genomics of loblolly pine (Pinus taeda, Pinaceae). Molecular Ecology 19: 3789-3805.</p>
<p>Thierry de Meeûs, Jérôme Goudet “A step-by-step tutorial to use HierFstat to analyse populations hierarchically structured at multiple levels.”, Infect. Genet. Evol., vol. 7, no. 6, 2007</p>
</div>

<!-- </div>
</div>
</div>
 -->

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
