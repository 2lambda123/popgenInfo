<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Stéphanie Manel" />

<meta name="date" content="2015-03-19" />

<title>Calculating Basic Population Genetic Statistics from SNP Data</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/spacelab.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>
<!---

<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
  padding-right: 50px;
  padding-left: -50px;
}
@media (max-width: 979px) {
  body {
    padding-top: 0;
  }
}

 offset scroll position for anchor links (for fixed navbar)  
@media (min-width: 980px) {
  .section h2 {
    padding-top: 52px;
    margin-top: -52px;
  }
  .section h3 {
    padding-top: 52px;
    margin-top: -52px;
  }
}


/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

</style>
-->



<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h2 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h3 {
  padding-top: 55px;
  margin-top: -55px;
}
/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}
/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}
</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; }
code > span.dt { color: #204a87; }
code > span.dv { color: #0000cf; }
code > span.bn { color: #0000cf; }
code > span.fl { color: #0000cf; }
code > span.ch { color: #4e9a06; }
code > span.st { color: #4e9a06; }
code > span.co { color: #8f5902; font-style: italic; }
code > span.ot { color: #8f5902; }
code > span.al { color: #ef2929; }
code > span.fu { color: #000000; }
code > span.er { font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- HOME -->
      <a class="navbar-brand" href="index.html"><b>Population Genetics in R</b></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <!-- Table of contents -->
        <li class="dropdown">
          <a href="chapters" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Users <span class="caret"></span></a>
          <ol class="dropdown-menu">
              <li><a href="GETSTARTED.html">Getting Started</a></li>
              <li class="divider"></li>
              <li class="dropdown-header">For SNP data:</li>
              <!-- <li class="divider"></li> -->
              <li><a href="StartSNP.html">Basic statistics</a></li>
              <li><a href="DifferentiationSNP.html">Population differentiation</a></li>
              <!-- <li><a href="SNP.html">SNPs</a></li> -->
              <li class="divider"></li>
              <li class="dropdown-header">For sequence data:</li>
              <!-- <li class="divider"></li>   -->
              <li><a href="SummarySequenceData.html">Summary statistics</a></li>
              <li><a href="PopDiffSequenceData.html">Population differentiation</a></li>
          </ol>
        </li>
        <!-- Appendices dropdown -->
        <li class="dropdown">
          <a href="appendices" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Package Developers <span class="caret"></span></a>
          <ul class = "dropdown-menu", role = "menu">
           <li><a href = "DEVELOPER.html">Introduction</a></li>  
          </ul>
        </li>
        <!-- Author button -->
        <li class="dropdown">
          <a href="about" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Contribute! <span class="caret"></span></a>
          <ul class = "dropdown-menu", role = "menu">
           <li><a href = "CONTRIBUTING.html">How to contribute</a></li>  
           <li><a href="https://github.com/NESCent/popgenInfo">Source repository</a></li>  
		  </ul>
        </li>
        <li class = "button">
          <a href="LinksToResources.html">Useful Links</a>
        </li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- <div class="container">
<div class="row">
<div class="span10 offset1"> -->

<div id="header">
<h1 class="title">Calculating Basic Population Genetic Statistics from SNP Data</h1>
<h4 class="author"><em>Stéphanie Manel</em></h4>
<h4 class="date"><em>March 19, 2015</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#load-necessary-resources-and-packages">Load necessary resources and packages</a></li>
<li><a href="#workflow-for-snp-data">Workflow for SNP data</a><ul>
<li><a href="#import-data">Import data</a></li>
<li><a href="#genetic-diversity-osberved-and-expected-heterozygosity">Genetic diversity (osberved and expected heterozygosity)</a></li>
<li><a href="#testing-for-hardy-weinberg-equilibrium">Testing for Hardy-Weinberg Equilibrium</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a><ul>
<li><a href="#what-did-we-learn-today">What did we learn today?</a></li>
<li><a href="#what-is-next">What is next?</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this vignette, you will calculate basic population genetic statistics from SNP data using R packages. These statistics serve as exploratory analysis and require to work at the population level. We will calculate:</p>
<ol style="list-style-type: decimal">
<li>Genetic diversity,</li>
<li>Test Hardy Weinberg</li>
<li><span class="math">\(F_{is}\)</span> and global <span class="math">\(F_{st}\)</span>.</li>
</ol>
<p>The dataset used for these analyses are for lodgepole pine (<em>Pinus contorta</em>, Pinaceae), a plant species. More information on the dataset and the species is available from <a href="http://eckertdata.blogspot.fr/">A. Eckert’s website</a>. Here we use the dataset with no presupposed idea of interpreting the results in a biological way. To make the calculations faster, we work only with a subset of the full dataset.</p>
</div>
<div id="load-necessary-resources-and-packages" class="section level1">
<h1>Load necessary resources and packages</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(adegenet)
<span class="kw">library</span>(hierfstat)
<span class="kw">library</span>(pegas)
<span class="kw">library</span>(genetics)</code></pre>
</div>
<div id="workflow-for-snp-data" class="section level1">
<h1>Workflow for SNP data</h1>
<div id="import-data" class="section level2">
<h2>Import data</h2>
<p>The data are stored in a text file (genotype=AA..). We will import the dataset into R as a data frame, and then convert the SNP data file into a <a href="http://www.inside-r.org/packages/cran/adegenet/docs/.valid.genind">genind</a> object.</p>
<p>The dataset “Master_Pinus_data_genotype.txt” can be downloaded <a href="https://github.com/NESCent/popgenInfo/tree/master/data/Master_Pinus_data_genotype.txt">here</a>.</p>
<p>The text file is a matrix of (550 rows x 3086 columns). It contains 4 extra columns: first column is the label of the individuals, the three other are description of the region, all the other columns are for the genotypes as (AA or AT…).</p>
<p>When you import the data into R, the data file needs to be in your working directory, or adjust the path in the <code>read.table()</code> invocation below accordingly.</p>
<pre class="sourceCode r"><code class="sourceCode r">Mydata &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;Master_Pinus_data_genotype.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="kw">dim</span>(Mydata) <span class="co"># Matrix of dimension 550x3086</span></code></pre>
<pre><code>## [1]  550 3086</code></pre>
<p>To work with the data, we need to convert the R object returned by <code>read.table()</code> to a <code>genind</code> object. To achieve this, we create a matrix with only genotypes, and keep only a subset of the first 11 SNP loci (to make calculations faster). The result can then be converted to a <code>genind</code> object (for package <code>adegent</code>). The <code>genind</code> object can then easily be converted into <code>fstat</code> (package <code>hierfstat</code>) and <code>loci</code> objects (package <code>pegas</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r">locus &lt;-<span class="st"> </span>Mydata[, -<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">16</span>:<span class="dv">3086</span>)]    
ind &lt;-<span class="st"> </span><span class="kw">as.character</span>(Mydata$tree_id) <span class="co"># labels of the individuals</span>
population &lt;-<span class="st"> </span><span class="kw">as.character</span>(Mydata$state) <span class="co"># labels of the populations</span>
Mydata1 &lt;-<span class="st"> </span><span class="kw">df2genind</span>(locus,<span class="dt">ploidy=</span><span class="dv">2</span>,<span class="dt">ind.names=</span>ind,<span class="dt">pop=</span>population)
Mydata1</code></pre>
<pre><code>## 
##    #####################
##    ### Genind object ### 
##    #####################
## - genotypes of individuals - 
## 
## S4 class:  genind
## @call: df2genind(X = locus, ind.names = ind, pop = population, ploidy = 2)
## 
## @tab:  550 x 22 matrix of genotypes
## 
## @ind.names: vector of  550 individual names
## @loc.names: vector of  11 locus names
## @loc.nall: number of alleles per locus
## @loc.fac: locus factor for the  22 columns of @tab
## @all.names: list of  11 components yielding allele names for each locus
## @ploidy:  2
## @type:  codom
## 
## Optional contents: 
## @pop:  factor giving the population of each individual
## @pop.names:  factor giving the population of each individual
## 
## @other: - empty -</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Mydata1@loc.nall</code></pre>
<pre><code>## L01 L02 L03 L04 L05 L06 L07 L08 L09 L10 L11 
##   2   2   2   2   2   2   2   2   2   2   2</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Mydata2 &lt;-<span class="st"> </span><span class="kw">genind2hierfstat</span>(Mydata1) 
Mydata3 &lt;-<span class="st"> </span><span class="kw">genind2loci</span>(Mydata1)</code></pre>
</div>
<div id="genetic-diversity-osberved-and-expected-heterozygosity" class="section level2">
<h2>Genetic diversity (osberved and expected heterozygosity)</h2>
<p>with adegenet</p>
<pre class="sourceCode r"><code class="sourceCode r">div &lt;-<span class="st"> </span><span class="kw">summary</span>(Mydata1)</code></pre>
<pre><code>## 
##  # Total number of genotypes:  550 
## 
##  # Population sample sizes:  
##       georgia      virginia northcarolina southcarolina       alabama 
##            10            73           177            58           169 
##      oklahoma      arkansas       florida   mississippi         texas 
##             7            10            24             9             9 
##     louisiana 
##             4 
## 
##  # Number of alleles per locus:  
## L01 L02 L03 L04 L05 L06 L07 L08 L09 L10 L11 
##   2   2   2   2   2   2   2   2   2   2   2 
## 
##  # Number of alleles per population:  
## 01 02 03 04 05 06 07 08 09 10 11 
## 20 22 22 21 22 18 18 21 20 18 17 
## 
##  # Percentage of missing data:  
## [1] 1.652893
## 
##  # Observed heterozygosity:  
##        L01        L02        L03        L04        L05        L06 
## 0.42329020 0.48979592 0.46198830 0.39741220 0.11970534 0.47329650 
##        L07        L08        L09        L10        L11 
## 0.07339450 0.07692308 0.11151737 0.45871560 0.04204753 
## 
##  # Expected heterozygosity:  
##        L01        L02        L03        L04        L05        L06 
## 0.40805006 0.49855260 0.49996960 0.44587281 0.12540148 0.49997287 
##        L07        L08        L09        L10        L11 
## 0.07409477 0.07733902 0.10854119 0.44238700 0.04465942</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">div</code></pre>
<pre><code>## $N
## [1] 550
## 
## $pop.eff
##       georgia      virginia northcarolina southcarolina       alabama 
##            10            73           177            58           169 
##      oklahoma      arkansas       florida   mississippi         texas 
##             7            10            24             9             9 
##     louisiana 
##             4 
## 
## $loc.nall
## L01 L02 L03 L04 L05 L06 L07 L08 L09 L10 L11 
##   2   2   2   2   2   2   2   2   2   2   2 
## 
## $pop.nall
## 01 02 03 04 05 06 07 08 09 10 11 
## 20 22 22 21 22 18 18 21 20 18 17 
## 
## $NA.perc
## [1] 1.652893
## 
## $Hobs
##        L01        L02        L03        L04        L05        L06 
## 0.42329020 0.48979592 0.46198830 0.39741220 0.11970534 0.47329650 
##        L07        L08        L09        L10        L11 
## 0.07339450 0.07692308 0.11151737 0.45871560 0.04204753 
## 
## $Hexp
##        L01        L02        L03        L04        L05        L06 
## 0.40805006 0.49855260 0.49996960 0.44587281 0.12540148 0.49997287 
##        L07        L08        L09        L10        L11 
## 0.07409477 0.07733902 0.10854119 0.44238700 0.04465942</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(div)</code></pre>
<pre><code>## [1] &quot;N&quot;        &quot;pop.eff&quot;  &quot;loc.nall&quot; &quot;pop.nall&quot; &quot;NA.perc&quot;  &quot;Hobs&quot;    
## [7] &quot;Hexp&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(div$Hobs, <span class="dt">xlab=</span><span class="st">&quot;Loci number&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Observed Heterozygosity&quot;</span>, 
     <span class="dt">main=</span><span class="st">&quot;Observed heterozygosity per locus&quot;</span>)</code></pre>
<p><img src="StartSNP_files/figure-html/Genetic_Diversity-1.png" title="" alt="" width="960" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(div$Hobs,div$Hexp, <span class="dt">xlab=</span><span class="st">&quot;Hobs&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Hexp&quot;</span>, 
     <span class="dt">main=</span><span class="st">&quot;Expected heterozygosity in function of observed heterozygosity per locus&quot;</span>)</code></pre>
<p><img src="StartSNP_files/figure-html/Genetic_Diversity-2.png" title="" alt="" width="960" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bartlett.test</span>(<span class="kw">list</span>(div$Hexp, div$Hobs)) <span class="co"># a test : H0: Hexp = Hobs</span></code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  list(div$Hexp, div$Hobs)
## Bartlett&#39;s K-squared = 0.014, df = 1, p-value = 0.9058</code></pre>
<p>We observed that heterozygosity varies among loci. We observed no difference between expected and observed heterozygosity.</p>
<p>Basic statistics with hierfstat. Populations are states. The function <code>basicstat</code> provides the observed heterozygosity (<span class="math">\(H_o\)</span>), mean gene diversities within population (<span class="math">\(H_s\)</span>), <span class="math">\(F_{is}\)</span>, and <span class="math">\(F_{st}\)</span> The function <code>boot.ppfis</code> provides confidence interval for <span class="math">\(F_{is}\)</span> The fuction <code>indpca</code> does an PCA on the centered matrix of individual’s allele frequencies.</p>
<pre class="sourceCode r"><code class="sourceCode r">basicstat &lt;-<span class="st"> </span><span class="kw">basic.stats</span>(Mydata2, <span class="dt">diploid =</span> <span class="ot">TRUE</span>, <span class="dt">digits =</span> <span class="dv">2</span>) 
<span class="kw">names</span>(basicstat)   </code></pre>
<pre><code>## [1] &quot;n.ind.samp&quot; &quot;pop.freq&quot;   &quot;Ho&quot;         &quot;Hs&quot;         &quot;Fis&quot;       
## [6] &quot;perloc&quot;     &quot;overall&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boot.ppfis</span>(Mydata2) </code></pre>
<pre><code>## $call
## boot.ppfis(dat = Mydata2)
## 
## $fis.ci
##         ll      hl
## 1  -0.0286  0.2728
## 2  -0.0619  0.0431
## 3   0.0008  0.0823
## 4  -0.0484  0.0959
## 5  -0.0472  0.0659
## 6  -0.5261  0.1858
## 7  -0.2676  0.1121
## 8  -0.2258 -0.0706
## 9  -0.1544  0.3469
## 10  0.0286  0.3225
## 11 -0.4117 -0.1354</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">indpca</span>(Mydata2) 
<span class="kw">plot</span>(x, <span class="dt">cex=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="StartSNP_files/figure-html/basic_statistics-1.png" title="" alt="" width="960" /></p>
</div>
<div id="testing-for-hardy-weinberg-equilibrium" class="section level2">
<h2>Testing for Hardy-Weinberg Equilibrium</h2>
<p>We used the pegas package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hw.test</span>(Mydata3, <span class="dt">B =</span> <span class="dv">1000</span>)</code></pre>
<pre><code>##                      chi^2 df Pr(chi^2 &gt;) Pr.exact
## X0.10037.01.257 0.75465490  1  0.38500645    0.466
## X0.10040.02.394 0.16628227  1  0.68343723    0.730
## X0.10044.01.392 2.96053195  1  0.08531987    0.067
## X0.10048.01.60  6.39076800  1  0.01147154    0.008
## X0.10051.02.166 1.12035389  1  0.28984227    0.299
## X0.10054.01.402 1.54582494  1  0.21375285    0.215
## X0.10067.03.111 0.04868128  1  0.82537403    0.536
## X0.10079.02.168 0.01579313  1  0.89999259    0.584
## X0.10112.01.169 0.41126025  1  0.52133054    1.000
## X0.10113.01.119 0.74248768  1  0.38886515    0.444
## X0.10116.01.165 1.87098306  1  0.17136253    0.252</code></pre>
<p>We get for each locus a test of significance of the null hypothesis: <span class="math">\(H_0\)</span> the locus is in HW equilibrium in the population. All but one locus are in HW equilibrium.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<div id="what-did-we-learn-today" class="section level2">
<h2>What did we learn today?</h2>
<p>In this vignette, we learned how to explore the patterns of genetic diversity and how to estimate the level of genetic differentiation in one population. Also, you have an idea of potential violations of the dataset to the null Wright-Fischer model.</p>
</div>
<div id="what-is-next" class="section level2">
<h2>What is next?</h2>
<p>You may now want to move into looking into population differentiation in more detail (See <a href="DifferentiationSNP.html">Calculating genetic differentiation and clustering methods from SNP data</a>)</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Eckert, A. J., A. D. Bower, S. C. González-Martínez, J. L. Wegrzyn, G. Coop and D. B. Neale. 2010. Back to nature: Ecological genomics of loblolly pine (Pinus taeda, Pinaceae). Molecular Ecology 19: 3789-3805. <a href="doi:[10.1111/j.1365-294X.2010.04698.x](http://dx.doi.org/10.1111/j.1365-294X.2010.04698.x)" class="uri">doi:[10.1111/j.1365-294X.2010.04698.x](http://dx.doi.org/10.1111/j.1365-294X.2010.04698.x)</a></p>
</div>

<!-- </div>
</div>
</div>
 -->

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
